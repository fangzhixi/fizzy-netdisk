<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fizzy.mapper.FileMapper">
    <select id="selectFile" parameterType="com.fizzy.pojo.File" resultType="com.fizzy.pojo.File">
        SELECT
            `element_id`,
            `parent_element_id`,
            `user_id`,
            `file_name`,
            `file_size`,
            `create_time`,
            `update_time`
        FROM
            `netdisk`.`file`
        <trim prefix="WHERE" suffixOverrides="AND">
            <if test="element_id != null and element_id != ''">
                element_id = #{element_id} AND
            </if>
            <if test="parent_element_id != null and parent_element_id != ''">
                parent_element_id = #{parent_element_id} AND
            </if>
            <if test="user_id != null and user_id != ''">
                user_id = #{user_id} AND
            </if>
            <if test="file_name != null and file_name != ''">
                file_name = #{file_name} AND
            </if>
            <if test="file_size != null and file_size != ''">
                file_size = #{file_size} AND
            </if>
        </trim>
        <if test="element_id != null and element_id != ''">
            LIMIT 1
        </if>
    </select>

    <insert id="insertFile" parameterType="com.fizzy.pojo.File">
        INSERT INTO `netdisk`.`File` (
          `address`,
          `master_key`,
          `create_time`
        )
        VALUES
        (
          #{address},
          #{master_key},
          #{create_time}
        )
    </insert>

    <update id="updateFile" parameterType="com.fizzy.pojo.File">
        UPDATE
        `netdisk`.`File`
        <trim prefix="SET(" suffix=")" suffixOverrides=",">
            <if test="address != null and address != ''">
                `address` = #{address},
            </if>
            <if test="used_space != null and used_space != ''">
                `used_space` = #{used_space},
            </if>
            <if test="free_space != null and free_space != ''">
                `free_space` = #{free_space},
            </if>
            <if test="master_key != null and master_key != }'">
                `master_key` = #{master_key},
            </if>
            <if test="create_time != null and create_time != ''">
                `create_time` = #{create_time},
            </if>
            <if test="update_time != null and update_time != ''">
                `update_time` = #{update_time},
            </if>
        </trim>
        WHERE `id` = #{id}
    </update>

    <delete id="deleteFile" parameterType="Integer">
        DELETE FROM `netdisk`.`File` WHERE `id` = #{id}
    </delete>
</mapper>
